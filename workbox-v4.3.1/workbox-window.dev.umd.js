(function(v,h){typeof exports=="object"&&typeof module<"u"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(v=v||self,h(v.workbox={}))})(this,function(v){"use strict";try{self["workbox:window:4.3.1"]&&_()}catch{}var h=function(i,n){return new Promise(function(t){var e=new MessageChannel;e.port1.onmessage=function(o){return t(o.data)},i.postMessage(n,[e.port2])})};function C(r,i){for(var n=0;n<i.length;n++){var t=i[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function L(r,i,n){return i&&C(r.prototype,i),n&&C(r,n),r}function E(r,i){r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.__proto__=i}function u(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}try{self["workbox:core:4.3.1"]&&_()}catch{}var m=function(){var i=this;this.promise=new Promise(function(n,t){i.resolve=n,i.reject=t})},s=function(){for(var r=!1,i={debug:"#7f8c8d",log:"#2ecc71",warn:"#f39c12",error:"#c0392b",groupCollapsed:"#3498db",groupEnd:null},n=function(a,l){var g;if(a==="groupCollapsed"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){var d;(d=console)[a].apply(d,l);return}var k=["background: "+i[a],"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"],W=r?[]:["%cworkbox",k.join(";")];(g=console)[a].apply(g,W.concat(l)),a==="groupCollapsed"&&(r=!0),a==="groupEnd"&&(r=!1)},t={},e=Object.keys(i),o=function(){var a=e[c];t[a]=function(){for(var l=arguments.length,g=new Array(l),d=0;d<l;d++)g[d]=arguments[d];n(a,g)}},c=0;c<e.length;c++)o();return t}(),R=function(){function r(){this._eventListenerRegistry={}}var i=r.prototype;return i.addEventListener=function(t,e){this._getEventListenersByType(t).add(e)},i.removeEventListener=function(t,e){this._getEventListenersByType(t).delete(e)},i.dispatchEvent=function(t){t.target=this,this._getEventListenersByType(t.type).forEach(function(e){return e(t)})},i._getEventListenersByType=function(t){return this._eventListenerRegistry[t]=this._eventListenerRegistry[t]||new Set},r}(),b=function(i,n){return new URL(i,location).href===new URL(n,location).href},p=function(i,n){Object.assign(this,n,{type:i})};function S(r,i){try{var n=r()}catch(t){return i(t)}return n&&n.then?n.then(void 0,i):n}function w(r){return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];try{return Promise.resolve(r.apply(this,i))}catch(t){return Promise.reject(t)}}}function U(r,i){var n=r();return n&&n.then?n.then(i):i(n)}function y(r,i,n){return n?i?i(r):r:((!r||!r.then)&&(r=Promise.resolve(r)),i?r.then(i):r)}function T(r,i){if(!i)return r&&r.then?r.then(x):Promise.resolve()}function x(){}var D=200,I=6e4,P=function(r){E(i,r);function i(t,e){var o;return e===void 0&&(e={}),o=r.call(this)||this,o._scriptURL=t,o._registerOptions=e,o._updateFoundCount=0,o._swDeferred=new m,o._activeDeferred=new m,o._controllingDeferred=new m,o._onMessage=o._onMessage.bind(u(u(o))),o._onStateChange=o._onStateChange.bind(u(u(o))),o._onUpdateFound=o._onUpdateFound.bind(u(u(o))),o._onControllerChange=o._onControllerChange.bind(u(u(o))),o}var n=i.prototype;return n.register=w(function(t){var e=this,o=t===void 0?{}:t,c=o.immediate,f=c===void 0?!1:c;if(e._registrationTime){s.error("Cannot re-register a Workbox instance after it has been registered. Create a new instance instead.");return}return U(function(){if(!f&&document.readyState!=="complete")return T(new Promise(function(a){return addEventListener("load",a)}))},function(){return e._isUpdate=!!navigator.serviceWorker.controller,e._compatibleControllingSW=e._getControllingSWIfCompatible(),y(e._registerScript(),function(a){e._registration=a,e._compatibleControllingSW&&(e._sw=e._compatibleControllingSW,e._activeDeferred.resolve(e._compatibleControllingSW),e._controllingDeferred.resolve(e._compatibleControllingSW),e._reportWindowReady(e._compatibleControllingSW),e._compatibleControllingSW.addEventListener("statechange",e._onStateChange,{once:!0}));var l=e._registration.waiting;l&&b(l.scriptURL,e._scriptURL)&&(e._sw=l,Promise.resolve().then(function(){e.dispatchEvent(new p("waiting",{sw:l,wasWaitingBeforeRegister:!0})),s.warn("A service worker was already waiting to activate before this script was registered...")})),e._sw&&e._swDeferred.resolve(e._sw);{s.log("Successfully registered service worker.",e._scriptURL),navigator.serviceWorker.controller&&(e._compatibleControllingSW?s.debug("A service worker with the same script URL is already controlling this page."):s.debug("A service worker with a different script URL is currently controlling the page. The browser is now fetching the new script now..."));var g=function(){var k=new URL(e._registerOptions.scope||e._scriptURL,document.baseURI),W=new URL("./",k.href).pathname;return!location.pathname.startsWith(W)};g()&&s.warn("The current page is not in scope for the registered service worker. Was this a mistake?")}return e._registration.addEventListener("updatefound",e._onUpdateFound),navigator.serviceWorker.addEventListener("controllerchange",e._onControllerChange,{once:!0}),"BroadcastChannel"in self&&(e._broadcastChannel=new BroadcastChannel("workbox"),e._broadcastChannel.addEventListener("message",e._onMessage)),navigator.serviceWorker.addEventListener("message",e._onMessage),e._registration})})}),n.getSW=w(function(){var t=this;return t._sw||t._swDeferred.promise}),n.messageSW=w(function(t){var e=this;return y(e.getSW(),function(o){return h(o,t)})}),n._getControllingSWIfCompatible=function(){var e=navigator.serviceWorker.controller;if(e&&b(e.scriptURL,this._scriptURL))return e},n._registerScript=w(function(){var t=this;return S(function(){return y(navigator.serviceWorker.register(t._scriptURL,t._registerOptions),function(e){return t._registrationTime=performance.now(),e})},function(e){throw s.error(e),e})}),n._reportWindowReady=function(e){h(e,{type:"WINDOW_READY",meta:"workbox-window"})},n._onUpdateFound=function(){var e=this._registration.installing,o=this._updateFoundCount>0||!b(e.scriptURL,this._scriptURL)||performance.now()>this._registrationTime+I;o?(this._externalSW=e,this._registration.removeEventListener("updatefound",this._onUpdateFound)):(this._sw=e,this._swDeferred.resolve(e),navigator.serviceWorker.controller?s.log("Updated service worker found. Installing now..."):s.log("Service worker is installing...")),++this._updateFoundCount,e.addEventListener("statechange",this._onStateChange)},n._onStateChange=function(e){var o=this,c=e.target,f=c.state,a=c===this._externalSW,l=a?"external":"",g={sw:c,originalEvent:e};switch(!a&&this._isUpdate&&(g.isUpdate=!0),this.dispatchEvent(new p(l+f,g)),f==="installed"?this._waitingTimeout=setTimeout(function(){f==="installed"&&o._registration.waiting===c&&(o.dispatchEvent(new p(l+"waiting",g)),a?s.warn("An external service worker has installed but is waiting for this client to close before activating..."):s.warn("The service worker has installed but is waiting for existing clients to close before activating..."))},D):f==="activating"&&(clearTimeout(this._waitingTimeout),a||this._activeDeferred.resolve(c)),f){case"installed":a?s.warn("An external service worker has installed. You may want to suggest users reload this page."):s.log("Registered service worker installed.");break;case"activated":a?s.warn("An external service worker has activated."):(s.log("Registered service worker activated."),c!==navigator.serviceWorker.controller&&s.warn("The registered service worker is active but not yet controlling the page. Reload or run `clients.claim()` in the service worker."));break;case"redundant":c===this._compatibleControllingSW?s.log("Previously controlling service worker now redundant!"):a||s.log("Registered service worker now redundant!");break}},n._onControllerChange=function(e){var o=this._sw;o===navigator.serviceWorker.controller&&(this.dispatchEvent(new p("controlling",{sw:o,originalEvent:e})),s.log("Registered service worker now controlling this page."),this._controllingDeferred.resolve(o))},n._onMessage=function(e){var o=e.data;this.dispatchEvent(new p("message",{data:o,originalEvent:e}))},L(i,[{key:"active",get:function(){return this._activeDeferred.promise}},{key:"controlling",get:function(){return this._controllingDeferred.promise}}]),i}(R);v.Workbox=P,v.messageSW=h,Object.defineProperty(v,"__esModule",{value:!0})});
