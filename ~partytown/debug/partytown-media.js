(m=>{const[a,b,n,j,K,B,S,I,D]=m.$bridgeToMedia$;delete m.$bridgeToMedia$;const O=Symbol(),v=Symbol(),M=Symbol(),R=Symbol(),p=Symbol(),E=Symbol(),$=[],g=(f,u,x)=>f[u]=w(u,x),w=(f,u)=>Object.defineProperty(u,"name",{value:f}),_=(f,u)=>{const x={getContext:{value(o,y){return this[O]||(this[O]=(o.includes("webgl")?P:C)(this,o,y)),this[O]}}},i=g(u,"CanvasGradient",class extends f{addColorStop(...o){n(this,["addColorStop"],o,2)}}),k=g(u,"CanvasPattern",class extends f{setTransform(...o){n(this,["setTransform"],o,2)}}),C=(o,y,c)=>{const L=o[S],T=B(),l={[S]:L,[I]:T,[D]:[]},h=n(o,["getContext"],[y,c],1,T),t="getContextAttributes,getImageData,getLineDash,getTransform,isPointInPath,isPointInStroke,measureText".split(","),e={get:(r,s)=>typeof s=="string"&&s in h?typeof h[s]=="function"?(...d)=>{if(s.startsWith("create")){const H=B();return n(l,[s],d,2,H),s==="createImageData"||s==="createPattern"?((Y=>{console.warn(`${Y} not implemented`)})(`${s}()`),{setTransform:()=>{}}):new i(L,H)}const W=t.includes(s)?1:2;return n(l,[s],d,W)}:h[s]:r[s],set(r,s,d){return typeof s=="string"&&s in h?(h[s]!==d&&typeof d!="function"&&b(l,[s],d),h[s]=d):r[s]=d,!0}};return new Proxy(h,e)},P=(o,y,c)=>{const L=o[S],T=B(),l={[S]:L,[I]:T,[D]:[]},h=n(o,["getContext"],[y,c],1,T),t={get:(e,r)=>typeof r=="string"?typeof h[r]!="function"?h[r]:(...s)=>n(l,[r],s,U(r)):e[r],set(e,r,s){return typeof r=="string"&&r in h?(h[r]!==s&&typeof s!="function"&&b(l,[r],s),h[r]=s):e[r]=s,!0}};return new Proxy(h,t)},A="checkFramebufferStatus,makeXRCompatible".split(","),U=o=>o.startsWith("create")||o.startsWith("get")||o.startsWith("is")||A.includes(o)?1:2;g(u,"CanvasGradient",i),g(u,"CanvasPattern",k),K(u.HTMLCanvasElement,x)},F=(f,u,x,i)=>{var k,C;i.Audio=w("HTMLAudioElement",class{constructor(t){const e=x.$createNode$("audio",B());return e.src=t,e}});const P=class extends f{get enabled(){return a(this,["enabled"])}set enabled(t){b(this,["enabled"],t)}get id(){return a(this,["id"])}get kind(){return a(this,["kind"])}get label(){return a(this,["label"])}get language(){return a(this,["language"])}get sourceBuffer(){return new o(this)}},A=class{constructor(t){const e=t[S],r=t[I],s={addEventListener(...d){n(t,["audioTracks","addEventListener"],d,3)},getTrackById:(...d)=>n(t,["audioTracks","getTrackById"],d),get length(){return a(t,["audioTracks","length"])},removeEventListener(...d){n(t,["audioTracks","removeEventListener"],d,3)}};return new Proxy(s,{get:(d,W)=>typeof W=="number"?new P(e,r,["audioTracks",W]):d[W]})}},U=g(i,"SourceBufferList",class extends Array{constructor(t){super(),this[v]=t}addEventListener(...t){n(this[v],["sourceBuffers","addEventListener"],t,3)}removeEventListener(...t){n(this[v],["sourceBuffers","removeEventListener"],t,3)}}),o=g(i,"SourceBuffer",(C=class extends u{constructor(t){super(t[S],t[I],["sourceBuffers"]),this[k]=[],this[v]=t}abort(){const t=c(this);n(this,[t,"appendWindowStart"],$,1)}addEventListener(...t){const e=c(this);n(this,[e,"addEventListener"],t,3)}appendBuffer(t){this[p].push(["appendBuffer",[t],t]),L(this)}get appendWindowStart(){const t=c(this);return a(this,[t,"appendWindowStart"])}set appendWindowStart(t){const e=c(this);b(this,[e,"appendWindowStart"],t)}get appendWindowEnd(){const t=c(this);return a(this,[t,"appendWindowEnd"])}set appendWindowEnd(t){const e=c(this);b(this,[e,"appendWindowEnd"],t)}get buffered(){const t=this[v],e=c(this);return new y(t[S],t[I],["sourceBuffers",e,"buffered"])}changeType(t){const e=c(this);n(this,[e,"changeType"],[t],2)}get mode(){const t=c(this);return a(this,[t,"mode"])}set mode(t){const e=c(this);b(this,[e,"mode"],t)}remove(t,e){this[p].push(["remove",[t,e]]),L(this)}removeEventListener(...t){const e=c(this);n(this,[e,"removeEventListener"],t,3)}get timestampOffset(){const t=c(this);return a(this,[t,"timestampOffset"])}set timestampOffset(t){const e=c(this);b(this,[e,"timestampOffset"],t)}get updating(){const t=c(this);return a(this,[t,"updating"])}},k=p,C)),y=g(i,"TimeRanges",class extends f{start(...t){return n(this,["start"],t)}end(...t){return n(this,["end"],t)}get length(){return a(this,["length"])}}),c=t=>t?t[v][R].indexOf(t):-1,L=t=>{if(t[p].length){if(!t.updating){const e=t[p].shift();if(e){const r=c(t);n(t,[r,e[0]],e[1],3,void 0,e[2])}}setTimeout(()=>L(t),50)}},T={buffered:{get(){return this[E]||(this[E]=new y(this[S],this[I],["buffered"]),setTimeout(()=>{this[E]=void 0},5e3)),this[E]}},readyState:{get(){return this[M]===4?4:(typeof this[M]!="number"&&(this[M]=a(this,["readyState"]),setTimeout(()=>{this[M]=void 0},1e3)),this[M])}}};g(i,"MediaSource",class extends u{constructor(){super(x.$winId$),this[R]=new U(this),j(this,"MediaSource",$)}get activeSourceBuffers(){return[]}addSourceBuffer(t){const e=new o(this);return this[R].push(e),n(this,["addSourceBuffer"],[t]),e}clearLiveSeekableRange(){n(this,["clearLiveSeekableRange"],$,2)}get duration(){return a(this,["duration"])}set duration(t){b(this,["duration"],t)}endOfStream(t){n(this,["endOfStream"],[t],3)}get readyState(){return a(this,["readyState"])}removeSourceBuffer(t){const e=c(t);e>-1&&(this[R].splice(e,1),n(this,["removeSourceBuffer"],[e],1))}setLiveSeekableRange(t,e){n(this,["setLiveSeekableRange"],[t,e],2)}get sourceBuffers(){return this[R]}static isTypeSupported(t){if(!G.has(t)){const e=n(i,["MediaSource","isTypeSupported"],[t]);G.set(t,e)}return G.get(t)}});const l=i.URL=w("URL",class extends URL{});"audioTracks"in i.HTMLMediaElement.prototype&&(g(i,"AudioTrackList",A),g(i,"AudioTrack",P),T.audioTracks={get(){return new A(this)}}),K(i.HTMLMediaElement,T),l.createObjectURL=t=>n(i,["URL","createObjectURL"],[t]),l.revokeObjectURL=t=>n(i,["URL","revokeObjectURL"],[t])},G=new Map;m.$bridgeFromMedia$=(f,u,x,i,k)=>{k.map(C=>{delete i[C]}),_(f,i),F(f,u,x,i)}})(self);
